## 多线程

### 线程的状态 todo

## 线程池

线程池的五种状态（Running、Shutdown、Stop、Tidying、Terminated）

任务通常分为两类：cpu密集型、io密集型

- cpu 密集型任务，需要线程长时间进行的复杂的运算，这种类型的任务需要少创建线程，过多的线程将会频繁引起上文切换，降低任务处理处理速度。
- io 密集型任务，由于线程并不是一直在运行，可能大部分时间在等待 IO 读取/写入数据，增加线程数量可以提高并发度，尽可能多处理任务。

因为原生线程池，任务数量大于核心线程数之后，会先把任务放到队列中，等待核心线程处理，这样对于io密集型任务的处理就不合理了，所以需要扩展线程池。

Tomcat扩展线程池，继承ThreadPoolExecutor，重写核心方法execute的处理逻辑，新增TaskQueue继承LinkedBlockingQueue，重写offer方法。

---

### 拒绝策略

ThreadPoolExecutor 也提供了 4 种默认的拒绝策略：

- DiscardPolicy()：丢弃掉该任务，不进行处理。

- DiscardOldestPolicy()：丢弃队列里最近的一个任务，并执行当前任务。

- AbortPolicy()：直接抛出 RejectedExecutionException 异常(默认)。

- CallerRunsPolicy()：既不抛弃任务也不抛出异常，直接使用主线程来执行此任务。


### 说说线程池创建需要的那几个核心参数的含义

ThreadPoolExecutor 最多包含以下七个参数：

- corePoolSize：线程池中的核心线程数

- maximumPoolSize：线程池中最大线程数

- keepAliveTime：闲置超时时间

- unit：keepAliveTime 超时时间的单位（时/分/秒等）

- workQueue：线程池中的任务队列

- threadFactory：为线程池提供创建新线程的线程工厂

- rejectedExecutionHandler：线程池任务队列超过最大值之后的拒绝策略



---